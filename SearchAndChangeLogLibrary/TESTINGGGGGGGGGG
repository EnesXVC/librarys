local SearchAndChangelogLibrary = {}

--services
local TweenService = game:GetService("TweenService")
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")
local Players = game:GetService("Players")
local CoreGui = game:GetService("CoreGui")
local TextService = game:GetService("TextService")

--theme
local SelectedTheme = {
	TextColor = Color3.fromRGB(240, 240, 240),
	Background = Color3.fromRGB(25, 25, 25),
	Topbar = Color3.fromRGB(34, 34, 34),
	Shadow = Color3.fromRGB(20, 20, 20),
	NotificationBackground = Color3.fromRGB(20, 20, 20),
	NotificationActionsBackground = Color3.fromRGB(230, 230, 230),
	TabBackground = Color3.fromRGB(80, 80, 80),
	TabStroke = Color3.fromRGB(85, 85, 85),
	TabBackgroundSelected = Color3.fromRGB(210, 210, 210),
	TabTextColor = Color3.fromRGB(240, 240, 240),
	SelectedTabTextColor = Color3.fromRGB(50, 50, 50),
	ElementBackground = Color3.fromRGB(35, 35, 35),
	ElementBackgroundHover = Color3.fromRGB(40, 40, 40),
	SecondaryElementBackground = Color3.fromRGB(25, 25, 25),
	ElementStroke = Color3.fromRGB(50, 50, 50),
	SecondaryElementStroke = Color3.fromRGB(40, 40, 40),
	SliderBackground = Color3.fromRGB(50, 138, 220),
	SliderProgress = Color3.fromRGB(50, 138, 220),
	SliderStroke = Color3.fromRGB(58, 163, 255),
	ToggleBackground = Color3.fromRGB(30, 30, 30),
	ToggleEnabled = Color3.fromRGB(0, 146, 214),
	ToggleDisabled = Color3.fromRGB(100, 100, 100),
	ToggleEnabledStroke = Color3.fromRGB(0, 170, 255),
	ToggleDisabledStroke = Color3.fromRGB(125, 125, 125),
	ToggleEnabledOuterStroke = Color3.fromRGB(100, 100, 100),
	ToggleDisabledOuterStroke = Color3.fromRGB(65, 65, 65),
	DropdownSelected = Color3.fromRGB(40, 40, 40),
	DropdownUnselected = Color3.fromRGB(30, 30, 30),
	InputBackground = Color3.fromRGB(30, 30, 30),
	InputStroke = Color3.fromRGB(65, 65, 65),
	PlaceholderColor = Color3.fromRGB(178, 178, 178)
}

-- // rayfield notify
local RayfieldLibrary = {}

-- // luna notify
local Luna = {
	Folder = "Luna",
	Options = {},
	ThemeGradient = ColorSequence.new{
		ColorSequenceKeypoint.new(0.00, Color3.fromRGB(117, 164, 206)),
		ColorSequenceKeypoint.new(0.50, Color3.fromRGB(123, 201, 201)),
		ColorSequenceKeypoint.new(1.00, Color3.fromRGB(224, 138, 175))
	}
}

--helper func
local function protectUI(sGui)
    if not sGui then return end
    
    if get_hidden_gui or gethui then
        local hiddenUI = get_hidden_gui or gethui
        sGui.Name = "ChangelogUI_"..tostring(math.random(10000,99999))
        sGui.Parent = hiddenUI()
    elseif syn and syn.protect_gui then
        syn.protect_gui(sGui)
        sGui.Parent = CoreGui
    else
        sGui.Parent = CoreGui
    end
    return sGui
end

local function getAssetUri(id)
	if type(id) == "number" then
		return "rbxassetid://" .. id
	else
		return "rbxassetid://0"
	end
end


-- ________RAYFIELDDDDDDDDDDDDDD_____

local Rayfield = Instance.new("ScreenGui")
Rayfield.Name = "Rayfield"
Rayfield.DisplayOrder = 100
Rayfield.ResetOnSpawn = false
Rayfield.Parent = SearchAndChangelogLibrary

local Notifications = Instance.new("Frame")
Notifications.Name = "Notifications"
Notifications.Parent = Rayfield
Notifications.AnchorPoint = Vector2.new(1, 1)
Notifications.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
Notifications.BackgroundTransparency = 1.000
Notifications.BorderSizePixel = 0
Notifications.Position = UDim2.new(1, -20, 1, -20)
Notifications.Size = UDim2.new(0, 300, 0, 800)

local UIListLayout = Instance.new("UIListLayout")
UIListLayout.Parent = Notifications
UIListLayout.HorizontalAlignment = Enum.HorizontalAlignment.Center
UIListLayout.SortOrder = Enum.SortOrder.LayoutOrder
UIListLayout.VerticalAlignment = Enum.VerticalAlignment.Bottom
UIListLayout.Padding = UDim.new(0, 8)

local Template = Instance.new("Frame")
Template.Name = "Template"
Template.Parent = Notifications
Template.BackgroundColor3 = SelectedTheme.NotificationBackground
Template.BackgroundTransparency = 0.450
Template.BorderSizePixel = 0
Template.Size = UDim2.new(1, 0, 0, 170)
Template.Visible = false

local UICorner = Instance.new("UICorner")
UICorner.CornerRadius = UDim.new(0, 20)
UICorner.Parent = Template

local UIStroke = Instance.new("UIStroke")
UIStroke.Name = "UIStroke"
UIStroke.Color = SelectedTheme.TextColor
UIStroke.Transparency = 1
UIStroke.Thickness = 1
UIStroke.Parent = Template

local Icon = Instance.new("ImageLabel")
Icon.Name = "Icon"
Icon.Parent = Template
Icon.AnchorPoint = Vector2.new(0, 0.5)
Icon.BackgroundColor3 = Color3.fromRGB(209, 209, 209)
Icon.BackgroundTransparency = 1.000
Icon.BorderSizePixel = 0
Icon.Position = UDim2.new(0, 25, 0.5, 0)
Icon.Size = UDim2.new(0, 24, 0, 24)
Icon.Image = "rbxassetid://0"
Icon.ImageColor3 = SelectedTheme.TextColor

local Description = Instance.new("TextLabel")
Description.Name = "Description"
Description.Parent = Template
Description.BackgroundTransparency = 1.000
Description.BorderSizePixel = 0
Description.Position = UDim2.new(0, 70, 0, 32)
Description.Size = UDim2.new(1, -80, 1, -40)
Description.ZIndex = 105
Description.Font = Enum.Font.Gotham
Description.Text = "Notification Content"
Description.TextColor3 = SelectedTheme.TextColor
Description.TextSize = 15.000
Description.TextTransparency = 0.350
Description.TextWrapped = true
Description.TextXAlignment = Enum.TextXAlignment.Left
Description.TextYAlignment = Enum.TextYAlignment.Top

local Title = Instance.new("TextLabel")
Title.Name = "Title"
Title.Parent = Template
Title.BackgroundTransparency = 1.000
Title.BorderSizePixel = 0
Title.Position = UDim2.new(0, 70, 0, 15)
Title.Size = UDim2.new(1, -80, 0, 16)
Title.ZIndex = 105
Title.Font = Enum.Font.GothamBold
Title.Text = "Notification Title"
Title.TextColor3 = SelectedTheme.TextColor
Title.TextSize = 16.000
Title.TextWrapped = true
Title.TextXAlignment = Enum.TextXAlignment.Left

local Shadow = Instance.new("ImageLabel")
Shadow.Name = "Shadow"
Shadow.Parent = Template
Shadow.AnchorPoint = Vector2.new(0.5, 0.5)
Shadow.BackgroundTransparency = 1.000
Shadow.BorderSizePixel = 0
Shadow.Position = UDim2.new(0.5, 0, 0.5, 0)
Shadow.Size = UDim2.new(1.11060238, 0, 1.92164946, 0)
Shadow.ZIndex = 0
Shadow.Image = "rbxassetid://3523728077"
Shadow.ImageColor3 = Color3.fromRGB(33, 33, 33)
Shadow.ImageTransparency = 0.820

function RayfieldLibrary:Notify(data)
	task.spawn(function()
		local newNotification = Template:Clone()
		newNotification.Name = data.Title or 'No Title Provided'
		newNotification.Parent = Notifications
		newNotification.LayoutOrder = #Notifications:GetChildren()
		newNotification.Visible = false

		newNotification.Title.Text = data.Title or "Unknown Title"
		newNotification.Description.Text = data.Content or "Unknown Content"

		if data.Image then
			newNotification.Icon.Image = getAssetUri(data.Image)
		else
			newNotification.Icon.Image = "rbxassetid://0"
		end

		newNotification.Title.TextColor3 = SelectedTheme.TextColor
		newNotification.Description.TextColor3 = SelectedTheme.TextColor
		newNotification.BackgroundColor3 = SelectedTheme.NotificationBackground
		newNotification.UIStroke.Color = SelectedTheme.TextColor
		newNotification.Icon.ImageColor3 = SelectedTheme.TextColor

		newNotification.BackgroundTransparency = 1
		newNotification.Title.TextTransparency = 1
		newNotification.Description.TextTransparency = 1
		newNotification.UIStroke.Transparency = 1
		newNotification.Shadow.ImageTransparency = 1
		newNotification.Size = UDim2.new(1, 0, 0, 800)
		newNotification.Icon.ImageTransparency = 1
		newNotification.Icon.BackgroundTransparency = 1

		task.wait()

		newNotification.Visible = true

		local bounds = {newNotification.Title.TextBounds.Y, newNotification.Description.TextBounds.Y}
		newNotification.Size = UDim2.new(1, -60, 0, -UIListLayout.Padding.Offset)

		newNotification.Icon.Size = UDim2.new(0, 32, 0, 32)
		newNotification.Icon.Position = UDim2.new(0, 20, 0.5, 0)

		TweenService:Create(newNotification, TweenInfo.new(0.6, Enum.EasingStyle.Exponential), {Size = UDim2.new(1, 0, 0, math.max(bounds[1] + bounds[2] + 31, 60))}):Play()

		task.wait(0.15)
		TweenService:Create(newNotification, TweenInfo.new(0.4, Enum.EasingStyle.Exponential), {BackgroundTransparency = 0.45}):Play()
		TweenService:Create(newNotification.Title, TweenInfo.new(0.3, Enum.EasingStyle.Exponential), {TextTransparency = 0}):Play()

		task.wait(0.05)

		TweenService:Create(newNotification.Icon, TweenInfo.new(0.3, Enum.EasingStyle.Exponential), {ImageTransparency = 0}):Play()

		task.wait(0.05)
		TweenService:Create(newNotification.Description, TweenInfo.new(0.3, Enum.EasingStyle.Exponential), {TextTransparency = 0.35}):Play()
		TweenService:Create(newNotification.UIStroke, TweenInfo.new(0.4, Enum.EasingStyle.Exponential), {Transparency = 0.95}):Play()
		TweenService:Create(newNotification.Shadow, TweenInfo.new(0.3, Enum.EasingStyle.Exponential), {ImageTransparency = 0.82}):Play()

		local waitDuration = math.min(math.max((#newNotification.Description.Text * 0.1) + 2.5, 3), 10)
		task.wait(data.Duration or waitDuration)

		newNotification.Icon.Visible = false
		TweenService:Create(newNotification, TweenInfo.new(0.4, Enum.EasingStyle.Exponential), {BackgroundTransparency = 1}):Play()
		TweenService:Create(newNotification.UIStroke, TweenInfo.new(0.4, Enum.EasingStyle.Exponential), {Transparency = 1}):Play()
		TweenService:Create(newNotification.Shadow, TweenInfo.new(0.3, Enum.EasingStyle.Exponential), {ImageTransparency = 1}):Play()
		TweenService:Create(newNotification.Title, TweenInfo.new(0.3, Enum.EasingStyle.Exponential), {TextTransparency = 1}):Play()
		TweenService:Create(newNotification.Description, TweenInfo.new(0.3, Enum.EasingStyle.Exponential), {TextTransparency = 1}):Play()

		TweenService:Create(newNotification, TweenInfo.new(1, Enum.EasingStyle.Exponential), {Size = UDim2.new(1, -90, 0, 0)}):Play()

		task.wait(1)

		TweenService:Create(newNotification, TweenInfo.new(1, Enum.EasingStyle.Exponential), {Size = UDim2.new(1, -90, 0, -UIListLayout.Padding.Offset)}):Play()

		newNotification.Visible = false
		newNotification:Destroy()
	end)
end

--______LUNAAAA____

local LunaUI = Instance.new("ScreenGui")
LunaUI.Name = "Luna UI"
LunaUI.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
LunaUI.DisplayOrder = 9999
LunaUI.Parent = SearchAndChangelogLibrary

local Notifications_2 = Instance.new("Frame")
Notifications_2.Name = "Notifications_2"
Notifications_2.Parent = LunaUI
Notifications_2.AnchorPoint = Vector2.new(1, 1)
Notifications_2.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
Notifications_2.BackgroundTransparency = 1.000
Notifications_2.BorderSizePixel = 0
Notifications_2.Position = UDim2.new(1, -20, 1, -20)
Notifications_2.Size = UDim2.new(0, 290, 0, 800)

local UIListLayout_2 = Instance.new("UIListLayout")
UIListLayout_2.Parent = Notifications_2
UIListLayout_2.HorizontalAlignment = Enum.HorizontalAlignment.Center
UIListLayout_2.SortOrder = Enum.SortOrder.LayoutOrder
UIListLayout_2.VerticalAlignment = Enum.VerticalAlignment.Bottom
UIListLayout_2.Padding = UDim.new(0, 8)

local Template_2 = Instance.new("Frame")
Template_2.Name = "Template_2"
Template_2.Parent = Notifications_2
Template_2.BackgroundColor3 = Color3.fromRGB(32, 30, 38)
Template_2.BackgroundTransparency = 0.500
Template_2.BorderSizePixel = 0
Template_2.Size = UDim2.new(1, 0, 0, 0)
Template_2.Visible = false

local UICorner_2 = Instance.new("UICorner")
UICorner_2.CornerRadius = UDim.new(0, 9)
UICorner_2.Parent = Template_2

local UIStroke_2 = Instance.new("UIStroke")
UIStroke_2.Name = "UIStroke_2"
UIStroke_2.Color = Color3.fromRGB(255, 255, 255)
UIStroke_2.Transparency = 1
UIStroke_2.Thickness = 1
UIStroke_2.Parent = Template_2

local Icon_2 = Instance.new("ImageLabel")
Icon_2.Name = "Icon_2"
Icon_2.Parent = Template_2
Icon_2.AnchorPoint = Vector2.new(0, 0.5)
Icon_2.BackgroundColor3 = Color3.fromRGB(209, 209, 209)
Icon_2.BackgroundTransparency = 1
Icon_2.BorderSizePixel = 0
Icon_2.Position = UDim2.new(0, 18, 0.5, 0)
Icon_2.Size = UDim2.new(0, 24, 0, 24)
Icon_2.Image = "rbxassetid://0"

local IconGradient_2 = Instance.new("UIGradient")
IconGradient_2.Color = ColorSequence.new{
	ColorSequenceKeypoint.new(0.00, Color3.fromRGB(255, 255, 255)),
	ColorSequenceKeypoint.new(1.00, Color3.fromRGB(171, 171, 171))
}
IconGradient_2.Rotation = 45
IconGradient_2.Parent = Icon_2

local Title_2 = Instance.new("TextLabel")
Title_2.Name = "Title_2"
Title_2.Parent = Template_2
Title_2.BackgroundTransparency = 1
Title_2.BorderSizePixel = 0
Title_2.Position = UDim2.new(0, 56, 0, 11)
Title_2.Size = UDim2.new(0.979548514, -80, 0, 16)
Title_2.ZIndex = 105
Title_2.Font = Enum.Font.GothamBold
Title_2.Text = "Notification System"
Title_2.TextColor3 = Color3.fromRGB(255, 255, 255)
Title_2.TextSize = 16
Title_2.TextWrapped = true
Title_2.TextXAlignment = Enum.TextXAlignment.Left

local TitleGradient_2 = Instance.new("UIGradient")
TitleGradient_2.Color = ColorSequence.new{
	ColorSequenceKeypoint.new(0.00, Color3.fromRGB(255, 255, 255)),
	ColorSequenceKeypoint.new(0.49, Color3.fromRGB(235, 235, 235)),
	ColorSequenceKeypoint.new(1.00, Color3.fromRGB(171, 171, 171))
}
TitleGradient_2.Rotation = 78
TitleGradient_2.Parent = Title_2

local Description_2 = Instance.new("TextLabel")
Description_2.Name = "Description_2"
Description_2.Parent = Template_2
Description_2.BackgroundTransparency = 1
Description_2.BorderSizePixel = 0
Description_2.Position = UDim2.new(0, 56, 0, 32)
Description_2.Size = UDim2.new(1, -80, 1, -50)
Description_2.ZIndex = 105
Description_2.Font = Enum.Font.Gotham
Description_2.Text = "This Is A Preview Of Luna's Dynamic Notification System"
Description_2.TextColor3 = Color3.fromRGB(255, 255, 255)
Description_2.TextSize = 14
Description_2.TextTransparency = 0.350
Description_2.TextWrapped = true
Description_2.TextXAlignment = Enum.TextXAlignment.Left
Description_2.TextYAlignment = Enum.TextYAlignment.Top

local DescGradient_2 = Instance.new("UIGradient")
DescGradient_2.Color = ColorSequence.new{
	ColorSequenceKeypoint.new(0.00, Color3.fromRGB(255, 255, 255)),
	ColorSequenceKeypoint.new(0.49, Color3.fromRGB(235, 235, 235)),
	ColorSequenceKeypoint.new(1.00, Color3.fromRGB(209, 209, 209))
}
DescGradient_2.Rotation = 90
DescGradient_2.Parent = Description_2

local Shadow_2 = Instance.new("ImageLabel")
Shadow_2.Name = "Shadow_2"
Shadow_2.Parent = Template_2
Shadow_2.AnchorPoint = Vector2.new(0.5, 0.5)
Shadow_2.BackgroundTransparency = 1
Shadow_2.BorderSizePixel = 0
Shadow_2.Position = UDim2.new(0.5, 0, 0.5, 0)
Shadow_2.Size = UDim2.new(1.18, 0, 1.92, 0)
Shadow_2.ZIndex = 0
Shadow_2.Image = "rbxassetid://3523728077"
Shadow_2.ImageColor3 = Color3.fromRGB(26, 25, 31)
Shadow_2.ImageTransparency = 0.500
Shadow_2.ScaleType = Enum.ScaleType.Slice
Shadow_2.SliceCenter = Rect.new(61, 4, 429, 100)

function Luna:Notification(data)
	task.spawn(function()
		local newNotification = Template:Clone()
		newNotification.Name = data.Title or "Missing Title"
		newNotification.Parent = Notifications
		newNotification.LayoutOrder = #Notifications:GetChildren()
		newNotification.Visible = false

		newNotification.Title.Text = data.Title or "Missing Title"
		newNotification.Description.Text = data.Content or "Missing or Unknown Content"
		
		if data.Image then
			newNotification.Icon.Image = getAssetUri(data.Image)
		else
			newNotification.Icon.Image = "rbxassetid://0"
		end

		newNotification.BackgroundTransparency = 1
		newNotification.Title.TextTransparency = 1
		newNotification.Description.TextTransparency = 1
		newNotification.UIStroke.Transparency = 1
		newNotification.Shadow.ImageTransparency = 1
		newNotification.Icon.ImageTransparency = 1
		newNotification.Icon.BackgroundTransparency = 1

		task.wait()

		newNotification.Size = UDim2.new(1, 0, 0, -UIListLayout.Padding.Offset)

		newNotification.Icon.Size = UDim2.new(0, 28, 0, 28)
		newNotification.Icon.Position = UDim2.new(0, 16, 0.5, -1)

		newNotification.Visible = true

		newNotification.Description.Size = UDim2.new(1, -65, 0, math.huge)
		local bounds = newNotification.Description.TextBounds.Y + 55
		newNotification.Description.Size = UDim2.new(1, -65, 0, bounds - 35)
		newNotification.Size = UDim2.new(1, 0, 0, -UIListLayout.Padding.Offset)
		
		TweenService:Create(newNotification, TweenInfo.new(0.6, Enum.EasingStyle.Exponential), {Size = UDim2.new(1, 0, 0, bounds)}):Play()

		task.wait(0.15)
		TweenService:Create(newNotification, TweenInfo.new(0.4, Enum.EasingStyle.Exponential), {BackgroundTransparency = 0.45}):Play()
		TweenService:Create(newNotification.Title, TweenInfo.new(0.3, Enum.EasingStyle.Exponential), {TextTransparency = 0}):Play()

		task.wait(0.05)

		TweenService:Create(newNotification.Icon, TweenInfo.new(0.3, Enum.EasingStyle.Exponential), {ImageTransparency = 0}):Play()

		task.wait(0.05)
		TweenService:Create(newNotification.Description, TweenInfo.new(0.3, Enum.EasingStyle.Exponential), {TextTransparency = 0.35}):Play()
		TweenService:Create(newNotification.UIStroke, TweenInfo.new(0.4, Enum.EasingStyle.Exponential), {Transparency = 0.95}):Play()
		TweenService:Create(newNotification.Shadow, TweenInfo.new(0.3, Enum.EasingStyle.Exponential), {ImageTransparency = 0.82}):Play()

		local waitDuration = math.min(math.max((#newNotification.Description.Text * 0.1) + 2.5, 3), 10)
		task.wait(data.Duration or waitDuration)

		newNotification.Icon.Visible = false
		TweenService:Create(newNotification, TweenInfo.new(0.4, Enum.EasingStyle.Exponential), {BackgroundTransparency = 1}):Play()
		TweenService:Create(newNotification.UIStroke, TweenInfo.new(0.4, Enum.EasingStyle.Exponential), {Transparency = 1}):Play()
		TweenService:Create(newNotification.Shadow, TweenInfo.new(0.3, Enum.EasingStyle.Exponential), {ImageTransparency = 1}):Play()
		TweenService:Create(newNotification.Title, TweenInfo.new(0.3, Enum.EasingStyle.Exponential), {TextTransparency = 1}):Play()
		TweenService:Create(newNotification.Description, TweenInfo.new(0.3, Enum.EasingStyle.Exponential), {TextTransparency = 1}):Play()

		TweenService:Create(newNotification, TweenInfo.new(1, Enum.EasingStyle.Exponential), {Size = UDim2.new(1, -90, 0, 0)}):Play()

		task.wait(1)

		TweenService:Create(newNotification, TweenInfo.new(1, Enum.EasingStyle.Exponential), {Size = UDim2.new(1, -90, 0, -UIListLayout.Padding.Offset)}):Play()

		newNotification.Visible = false
		newNotification:Destroy()
	end)
end

function SearchAndChangelogLibrary:Notify(data)
if not self.NotifyLibrary or string.lower(self.NotifyLibrary) == "rayfield" then
RayfieldLibrary:Notify(data)
else
Luna:Notification(data)
end

function SearchAndChangelogLibrary:CreateChangelogDialog(config)
    local changelogText = type(config) == "string" and config or (type(config) == "table" and config.ChangelogText or "")
    local showSearchBar = type(config) == "table" and config.Search ~= false
    local dialogTitle = type(config) == "table" and config.Title or "Changelog"
    local notificationsEnabled = type(config) == "table" and config.Notifications ~= false
    local altButton = type(config) == "table" and config.Altbutton or { Name = "Join Discord", Clipboard = "discord.gg/rTw5M8dRXN" }
    local notification = type(config) == "table" and config.Notification or { Title = "Changelog Closed", Content = "The changelog has been closed", Duration = 2.5, Image = 10723346871 }
    local altButtonNotification = type(config) == "table" and config.AltbuttonNotification or {
        Success = { Title = "Copied", Content = "The link has been copied to your clipboard!", Duration = 6.5, Image = 10709798443 },
        Failure = { Title = "Failed", Content = "Your executor doesn't support setclipboard.", Duration = 6.5, Image = 10709799124 }
    }
    
    self.NotifyLibrary = type(config) == "table" and config.NotifyLibrary or "Rayfield"
    
    if changelogText == "" then
        changelogText = [[
        Version: Build 1.0
        Release Date: ???

        What's New
        ???

        Improvements
        ???

        Bug Fixes
        ???

        Known Issues
        ???

        Notes
        ???
        ]]
    end

    local screenGui = Instance.new("ScreenGui")
    protectUI(screenGui)

    local ChangelogDialog = Instance.new("Frame")
    ChangelogDialog.Name = "ChangelogDialog"
    local screenSize = workspace.CurrentCamera.ViewportSize
    local minSize = Vector2.new(500, 400)
    local isMobile = UserInputService.TouchEnabled or (screenSize.X < minSize.X and screenSize.Y < minSize.Y)
    local dialogWidth = isMobile and math.clamp(screenSize.X * 0.8, 250, 450) or math.clamp(screenSize.X * 0.4, 400, 550)
    local dialogHeight = isMobile and math.clamp(screenSize.Y * 0.6, 300, 550) or math.clamp(screenSize.Y * 0.6, 400, 600)
    
    ChangelogDialog.Size = UDim2.new(0, dialogWidth, 0, dialogHeight)
    ChangelogDialog.Position = UDim2.new(0.5, 0, 0, isMobile and 40 or 60)
    ChangelogDialog.AnchorPoint = Vector2.new(0.5, 0)
    ChangelogDialog.BackgroundColor3 = SelectedTheme.Background
    ChangelogDialog.BackgroundTransparency = 0
    ChangelogDialog.BorderSizePixel = 0
    ChangelogDialog.ZIndex = 100
    ChangelogDialog.Visible = false
    ChangelogDialog.Parent = screenGui

    local DialogCorner = Instance.new("UICorner")
    DialogCorner.CornerRadius = UDim.new(0, 6)
    DialogCorner.Parent = ChangelogDialog

    local DialogStroke = Instance.new("UIStroke")
    DialogStroke.Color = SelectedTheme.ElementStroke
    DialogStroke.Thickness = 1
    DialogStroke.Transparency = 0
    DialogStroke.Parent = ChangelogDialog

    local DialogShadow = Instance.new("ImageLabel")
    DialogShadow.Name = "Shadow"
    DialogShadow.Image = "rbxassetid://1316045217"
    DialogShadow.Size = UDim2.new(1, 26, 1, 26)
    DialogShadow.Position = UDim2.new(0, -13, 0, -13)
    DialogShadow.BackgroundTransparency = 1
    DialogShadow.ImageTransparency = 0.5
    DialogShadow.ImageColor3 = SelectedTheme.Shadow
    DialogShadow.ScaleType = Enum.ScaleType.Slice
    DialogShadow.SliceCenter = Rect.new(10, 10, 118, 118)
    DialogShadow.ZIndex = 99
    DialogShadow.Parent = ChangelogDialog

    local DialogTitle = Instance.new("TextLabel")
    DialogTitle.Name = "Title"
    DialogTitle.Size = UDim2.new(1, -20, 0, 30)
    DialogTitle.Position = UDim2.new(0, 10, 0, 10)
    DialogTitle.BackgroundTransparency = 1
    DialogTitle.Text = dialogTitle
    DialogTitle.TextColor3 = SelectedTheme.TextColor
    DialogTitle.TextSize = isMobile and 20 or 24
    DialogTitle.Font = Enum.Font.SourceSansBold
    DialogTitle.TextXAlignment = Enum.TextXAlignment.Left
    DialogTitle.ZIndex = 101
    DialogTitle.Parent = ChangelogDialog

    local SearchBar, SearchStroke, SearchIcon, SearchInput
    if showSearchBar then
        SearchBar = Instance.new("Frame")
        SearchBar.Name = "Search"
        SearchBar.Size = UDim2.new(1, -20, 0, isMobile and 30 or 35)
        SearchBar.Position = UDim2.new(0, 10, 0, 45)
        SearchBar.BackgroundColor3 = SelectedTheme.TextColor
        SearchBar.BackgroundTransparency = 0.9
        SearchBar.ZIndex = 101
        SearchBar.Parent = ChangelogDialog

        local SearchCorner = Instance.new("UICorner")
        SearchCorner.CornerRadius = UDim.new(0, 4)
        SearchCorner.Parent = SearchBar

        SearchStroke = Instance.new("UIStroke")
        SearchStroke.Color = SelectedTheme.ElementStroke
        SearchStroke.Thickness = 1
        SearchStroke.Transparency = 0.8
        SearchStroke.Parent = SearchBar

        SearchIcon = Instance.new("ImageLabel")
        SearchIcon.Name = "SearchIcon"
        SearchIcon.Image = "rbxassetid://10734943674"
        SearchIcon.ImageColor3 = SelectedTheme.TextColor
        SearchIcon.ImageTransparency = 0.5
        SearchIcon.BackgroundTransparency = 1
        SearchIcon.Size = UDim2.new(0, isMobile and 18 or 20, 0, isMobile and 18 or 20)
        SearchIcon.Position = UDim2.new(0, 10, 0.5, isMobile and -9 or -10)
        SearchIcon.ZIndex = 102
        SearchIcon.Parent = SearchBar

        SearchInput = Instance.new("TextBox")
        SearchInput.Name = "Input"
        SearchInput.Text = ""
        SearchInput.PlaceholderText = "Search..."
        SearchInput.PlaceholderColor3 = (SelectedTheme.TextColor):Lerp(Color3.new(0, 0, 0), 0.5)
        SearchInput.TextColor3 = SelectedTheme.TextColor
        SearchInput.TextTransparency = 0.2
        SearchInput.TextSize = isMobile and 14 or 16
        SearchInput.Font = Enum.Font.SourceSans
        SearchInput.BackgroundTransparency = 1
        SearchInput.Size = UDim2.new(1, -40, 1, 0)
        SearchInput.Position = UDim2.new(0, 35, 0, 0)
        SearchInput.TextXAlignment = Enum.TextXAlignment.Left
        SearchInput.ZIndex = 102
        SearchInput.Parent = SearchBar
    end

    local ChangelogScroll = Instance.new("ScrollingFrame")
    ChangelogScroll.Name = "ChangelogScroll"
    ChangelogScroll.Size = UDim2.new(1, -20, 1, isMobile and (showSearchBar and -125 or -90) or (showSearchBar and -150 or -110))
    ChangelogScroll.Position = UDim2.new(0, 10, 0, isMobile and (showSearchBar and 85 or 50) or (showSearchBar and 90 or 50))
    ChangelogScroll.BackgroundTransparency = 1
    ChangelogScroll.ScrollBarThickness = isMobile and 3 or 4
    ChangelogScroll.ScrollBarImageColor3 = SelectedTheme.ElementStroke
    ChangelogScroll.CanvasSize = UDim2.new(0, 0, 0, 0)
    ChangelogScroll.ZIndex = 101
    ChangelogScroll.Parent = ChangelogDialog

    local ScrollListLayout = Instance.new("UIListLayout")
    ScrollListLayout.Padding = UDim.new(0, 5)
    ScrollListLayout.SortOrder = Enum.SortOrder.LayoutOrder
    ScrollListLayout.Parent = ChangelogScroll

    local function addTextLabel(text, isHeader, layoutOrder)
        local TextLabel = Instance.new("TextLabel")
        TextLabel.Size = UDim2.new(1, -10, 0, 0)
        TextLabel.AutomaticSize = Enum.AutomaticSize.Y
        TextLabel.BackgroundTransparency = 1
        TextLabel.Text = text
        TextLabel.TextColor3 = SelectedTheme.TextColor
        TextLabel.TextTransparency = 0
        TextLabel.TextSize = isMobile and (isHeader and 18 or 16) or (isHeader and 22 or 18)
        TextLabel.Font = isHeader and Enum.Font.SourceSansBold or Enum.Font.SourceSans
        TextLabel.TextXAlignment = Enum.TextXAlignment.Left
        TextLabel.TextWrapped = true
        TextLabel.LayoutOrder = layoutOrder
        TextLabel.ZIndex = 102
        
        if isHeader and (text:match("%[%+%]") or text:match("%[%-%]") or text:match("%[%*%]") or text:match("%[!%]") or text:match("%[%?%]")) then
            TextLabel.BackgroundTransparency = 0
            TextLabel.BackgroundColor3 = SelectedTheme.ElementBackgroundHover
            local HighlightCorner = Instance.new("UICorner")
            HighlightCorner.CornerRadius = UDim.new(0, 4)
            HighlightCorner.Parent = TextLabel
        end
        
        TextLabel.Parent = ChangelogScroll
        return TextLabel
    end

    local originalLabels = {}
    local layoutOrder = 0
    for line in changelogText:gmatch("[^\r\n]+") do
        line = line:match("^%s*(.-)%s*$")
        local isHeader = line:match("^%[%+%]") or line:match("^%[%-%]") or line:match("^%[%*%]") or line:match("^%[!%]") or line:match("^%[%?%]") or line:match("^Version:") or line:match("^Release Date:") or line:match("^What's New") or line:match("^Improvements") or line:match("^Bug Fixes") or line:match("^Known Issues") or line:match("^Notes")
        local label = addTextLabel(line, isHeader, layoutOrder)
        table.insert(originalLabels, {text = line, isHeader = isHeader, layoutOrder = layoutOrder})
        layoutOrder = layoutOrder + 1
    end

    ScrollListLayout:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
        ChangelogScroll.CanvasSize = UDim2.new(0, 0, 0, ScrollListLayout.AbsoluteContentSize.Y)
    end)

    if showSearchBar then
        SearchInput:GetPropertyChangedSignal("Text"):Connect(function()
            local query = SearchInput.Text:lower()
            for _, label in ipairs(ChangelogScroll:GetChildren()) do
                if label:IsA("TextLabel") then
                    label:Destroy()
                end
            end
            local newLayoutOrder = 0
            if query == "" then
                for _, entry in ipairs(originalLabels) do
                    addTextLabel(entry.text, entry.isHeader, newLayoutOrder)
                    newLayoutOrder = newLayoutOrder + 1
                end
            else
                for _, entry in ipairs(originalLabels) do
                    if entry.text:lower():find(query, 1, true) then
                        addTextLabel(entry.text, entry.isHeader, newLayoutOrder)
                        newLayoutOrder = newLayoutOrder + 1
                    end
                end
            end
        end)
    end

    local CloseButton = Instance.new("TextButton")
    CloseButton.Name = "CloseButton"
    CloseButton.Size = UDim2.new(0, isMobile and 60 or 80, 0, isMobile and 25 or 30)
    CloseButton.Position = UDim2.new(1, isMobile and -70 or -90, 1, isMobile and -35 or -40)
    CloseButton.BackgroundColor3 = SelectedTheme.ElementBackground
    CloseButton.BackgroundTransparency = 0
    CloseButton.Text = "Close"
    CloseButton.TextColor3 = SelectedTheme.TextColor
    CloseButton.TextSize = isMobile and 16 or 18
    CloseButton.Font = Enum.Font.SourceSansBold
    CloseButton.ZIndex = 101
    CloseButton.Parent = ChangelogDialog

    local CloseCorner = Instance.new("UICorner")
    CloseCorner.CornerRadius = UDim.new(0, 4)
    CloseCorner.Parent = CloseButton

    local CloseStroke = Instance.new("UIStroke")
    CloseStroke.Color = SelectedTheme.ElementStroke
    CloseStroke.Thickness = 1
    CloseStroke.Parent = CloseButton

    CloseButton.MouseEnter:Connect(function()
        TweenService:Create(CloseButton, TweenInfo.new(0.3, Enum.EasingStyle.Exponential), {BackgroundColor3 = SelectedTheme.ElementBackgroundHover}):Play()
    end)
    CloseButton.MouseLeave:Connect(function()
        TweenService:Create(CloseButton, TweenInfo.new(0.3, Enum.EasingStyle.Exponential), {BackgroundColor3 = SelectedTheme.ElementBackground}):Play()
    end)

    local AltButton = Instance.new("TextButton")
    AltButton.Name = "AltButton"
    AltButton.Size = UDim2.new(0, isMobile and 100 or 120, 0, isMobile and 25 or 30)
    AltButton.Position = UDim2.new(0, 10, 1, isMobile and -35 or -40)
    AltButton.BackgroundColor3 = SelectedTheme.ElementBackground
    AltButton.BackgroundTransparency = 0
    AltButton.Text = altButton.Name
    AltButton.TextColor3 = SelectedTheme.TextColor
    AltButton.TextSize = isMobile and 16 or 18
    AltButton.Font = Enum.Font.SourceSansBold
    AltButton.ZIndex = 101
    AltButton.Parent = ChangelogDialog

    local AltCorner = Instance.new("UICorner")
    AltCorner.CornerRadius = UDim.new(0, 4)
    AltCorner.Parent = AltButton

    local AltStroke = Instance.new("UIStroke")
    AltStroke.Color = SelectedTheme.ElementStroke
    AltStroke.Thickness = 1
    AltStroke.Parent = AltButton

    AltButton.MouseEnter:Connect(function()
        TweenService:Create(AltButton, TweenInfo.new(0.3, Enum.EasingStyle.Exponential), {BackgroundColor3 = SelectedTheme.ElementBackgroundHover}):Play()
    end)
    AltButton.MouseLeave:Connect(function()
        TweenService:Create(AltButton, TweenInfo.new(0.3, Enum.EasingStyle.Exponential), {BackgroundColor3 = SelectedTheme.ElementBackground}):Play()
    end)

    AltButton.MouseButton1Click:Connect(function()
        if setclipboard then
            setclipboard(altButton.Clipboard)
            if notificationsEnabled then
                self:Notify(altButtonNotification.Success)
            end
        else
            if notificationsEnabled then
                self:Notify(altButtonNotification.Failure)
            end
        end
    end)

    local function showDialog()
        ChangelogDialog.Visible = true
        ChangelogDialog.Size = UDim2.new(0, 0, 0, 0)
        DialogShadow.ImageTransparency = 1
        DialogTitle.TextTransparency = 1
        CloseButton.TextTransparency = 1
        CloseButton.BackgroundTransparency = 0
        CloseStroke.Transparency = 1
        AltButton.TextTransparency = 1
        AltButton.BackgroundTransparency = 0
        AltStroke.Transparency = 1
        
        if showSearchBar then
            SearchBar.BackgroundTransparency = 1
            SearchStroke.Transparency = 1
            SearchIcon.ImageTransparency = 1
            SearchInput.TextTransparency = 1
        end
        
        TweenService:Create(ChangelogDialog, TweenInfo.new(0.5, Enum.EasingStyle.Exponential), {Size = UDim2.new(0, dialogWidth, 0, dialogHeight)}):Play()
        TweenService:Create(DialogShadow, TweenInfo.new(0.5, Enum.EasingStyle.Exponential), {ImageTransparency = 0.5}):Play()
        TweenService:Create(DialogTitle, TweenInfo.new(0.5, Enum.EasingStyle.Exponential), {TextTransparency = 0}):Play()
        TweenService:Create(CloseButton, TweenInfo.new(0.5, Enum.EasingStyle.Exponential), {TextTransparency = 0, BackgroundTransparency = 0}):Play()
        TweenService:Create(CloseStroke, TweenInfo.new(0.5, Enum.EasingStyle.Exponential), {Transparency = 0}):Play()
        TweenService:Create(AltButton, TweenInfo.new(0.5, Enum.EasingStyle.Exponential), {TextTransparency = 0, BackgroundTransparency = 0}):Play()
        TweenService:Create(AltStroke, TweenInfo.new(0.5, Enum.EasingStyle.Exponential), {Transparency = 0}):Play()
        
        if showSearchBar then
            TweenService:Create(SearchBar, TweenInfo.new(0.5, Enum.EasingStyle.Exponential), {BackgroundTransparency = 0.9}):Play()
            TweenService:Create(SearchStroke, TweenInfo.new(0.5, Enum.EasingStyle.Exponential), {Transparency = 0.8}):Play()
            TweenService:Create(SearchIcon, TweenInfo.new(0.5, Enum.EasingStyle.Exponential), {ImageTransparency = 0.5}):Play()
            TweenService:Create(SearchInput, TweenInfo.new(0.5, Enum.EasingStyle.Exponential), {TextTransparency = 0.2}):Play()
        end
        
        for _, label in ipairs(ChangelogScroll:GetChildren()) do
            if label:IsA("TextLabel") then
                label.TextTransparency = 1
                local tween = TweenService:Create(label, TweenInfo.new(0.5, Enum.EasingStyle.Exponential), {TextTransparency = 0})
                tween:Play()
                task.wait(0.02)
            end
        end
    end

    local function hideDialog()
        TweenService:Create(ChangelogDialog, TweenInfo.new(0.5, Enum.EasingStyle.Exponential), {
            Size = UDim2.new(0, 0, 0, 0),
            BackgroundTransparency = 1
        }):Play()
        
        TweenService:Create(DialogShadow, TweenInfo.new(0.5, Enum.EasingStyle.Exponential), {ImageTransparency = 1}):Play()
        TweenService:Create(DialogTitle, TweenInfo.new(0.5, Enum.EasingStyle.Exponential), {TextTransparency = 1}):Play()
        TweenService:Create(CloseButton, TweenInfo.new(0.5, Enum.EasingStyle.Exponential), {TextTransparency = 1, BackgroundTransparency = 1}):Play()
        TweenService:Create(CloseStroke, TweenInfo.new(0.5, Enum.EasingStyle.Exponential), {Transparency = 1}):Play()
        TweenService:Create(AltButton, TweenInfo.new(0.5, Enum.EasingStyle.Exponential), {TextTransparency = 1, BackgroundTransparency = 1}):Play()
        TweenService:Create(AltStroke, TweenInfo.new(0.5, Enum.EasingStyle.Exponential), {Transparency = 1}):Play()
        
        if showSearchBar then
            TweenService:Create(SearchBar, TweenInfo.new(0.5, Enum.EasingStyle.Exponential), {BackgroundTransparency = 1}):Play()
            TweenService:Create(SearchStroke, TweenInfo.new(0.5, Enum.EasingStyle.Exponential), {Transparency = 1}):Play()
            TweenService:Create(SearchIcon, TweenInfo.new(0.5, Enum.EasingStyle.Exponential), {ImageTransparency = 1}):Play()
            TweenService:Create(SearchInput, TweenInfo.new(0.5, Enum.EasingStyle.Exponential), {TextTransparency = 1}):Play()
        end
        
        for _, label in ipairs(ChangelogScroll:GetChildren()) do
            if label:IsA("TextLabel") then
                TweenService:Create(label, TweenInfo.new(0.5, Enum.EasingStyle.Exponential), {TextTransparency = 1}):Play()
            end
        end

        task.wait(0.5)
        screenGui:Destroy()

        if notificationsEnabled then
            self:Notify(notification)
        end
    end

    CloseButton.MouseButton1Click:Connect(hideDialog)

    local dragging
    local dragInput
    local dragStart
    local startPos
    
    local function update(input)
        local delta = input.Position - dragStart
        local newPosition = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
        ChangelogDialog.Position = newPosition
    end

    ChangelogDialog.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
            dragging = true
            dragStart = input.Position
            startPos = ChangelogDialog.Position
            
            input.Changed:Connect(function()
                if input.UserInputState == Enum.UserInputState.End then
                    dragging = false
                end
            end)
        end
    end)

    ChangelogDialog.InputChanged:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch then
            dragInput = input
        end
    end)

    UserInputService.InputChanged:Connect(function(input)
        if input == dragInput and dragging then
            update(input)
        end
    end)

    showDialog()
    
    return {
        Hide = hideDialog,
        Show = showDialog
    }
end

return SearchAndChangelogLibrary
